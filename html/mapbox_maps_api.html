<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css' rel='stylesheet'/>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />

    <title>Mapz!!</title>
</head>
<body>
    <div>
        <h1>My 1st map!!</h1>
        <div id='map' style='width: 100%; height: 700px;'></div>
    </div>

</div>
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
<script src="../js/mapbox-geocoder-utils.js"></script>
<script>

    let mapboxToken = 'pk.eyJ1IjoiY2hhcmxlc3cxMTYiLCJhIjoiY2t5dW5oYm8yMGc4djJ2cGl4eGJvdHBmOSJ9.HOyJMqOoXCHENkAzhN0iCw';

    mapboxgl.accessToken = mapboxToken;
    let map = new mapboxgl.Map({
        container: 'map', // container ID
        style: 'mapbox://styles/mapbox/streets-v9', // style URL
        center: [-98.4916, 29.4252], // starting position [lng, lat]
        zoom: 20 // starting zoom
    });

    geocode("18039 W I-10, San Antonio, TX 78257", mapboxToken).then(function (result) {
        console.log(result);
        map.setCenter(result);
        map.setZoom(5);
    });

    let paneraInfo = {
        address: "18039 W I-10, San Antonio, TX 78257",
        popupHTML: "<p>Panera Bread!</p>"
    };
    // Create a new marker.
    const marker = new mapboxgl.Marker()
        .setLngLat([-98.4916, 29.4252])
        .addTo(map);

    const markerHeight = 50;
    const markerRadius = 10;
    const linearOffset = 25;
    const popupOffsets = {
        'top': [0, 0],
        'top-left': [0, 0],
        'top-right': [0, 0],
        'bottom': [0, -markerHeight],
        'bottom-left': [linearOffset, (markerHeight - markerRadius + linearOffset) * -1],
        'bottom-right': [-linearOffset, (markerHeight - markerRadius + linearOffset) * -1],
        'left': [markerRadius, (markerHeight - markerRadius) * -1],
        'right': [-markerRadius, (markerHeight - markerRadius) * -1]
    };
    const popup = new mapboxgl.Popup({offset: popupOffsets, className: 'my-class'})
        .setLngLat([-98.4916, 29.4252])
        .setHTML("<h1>Hello World!</h1>")
        .setMaxWidth("300px")
        .addTo(map);

    function placeMarkerAndPopup(info, token, map) {
        geocode(info.address, token).then(function (coordinates) {
            let popup = new mapboxgl.Popup()
                .setHTML(info.popupHTML);
            let marker = new mapboxgl.Marker()
                .setLngLat(coordinates)
                .addTo(map)
                .setPopup(popup);
            popup.addTo(map);
        });

        placeMarkerAndPopup(paneraInfo, mapboxToken, map);



    }


</script>
</body>
</html>